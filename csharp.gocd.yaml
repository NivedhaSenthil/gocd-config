pipelines:
  CSharp-Lib:
    group: Gauge-Csharp
    materials:
      dotnet:
        git: https://github.com/getgauge/gauge-csharp-lib.git
    stages:
      - test:
          jobs:
            test:
              resources:
                - windows
                - package
              tasks:
               - exec:
                   command: build
                   arguments:
                    - build
               - exec:
                   command: build
                   arguments:
                    - test
      - package:
          jobs:
            package:
              resources:
                - windows
                - package
              tasks:
               - exec:
                   command: build
                   arguments:
                    - build
               - exec:
                   command: build
                   arguments:
                    - package
              artifacts:
               - build:
                   source: artifacts/
      - release:
          approval: manual
          jobs:
            nuget:
              resources:
                - windows
                - nuget
              tasks:
                - fetch:
                    pipeline: CSharp-Lib
                    stage: package
                    job: package
                    source: artifacts
